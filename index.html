<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Video Compressor</title>
  <style>
    body { font-family: sans-serif; padding: 2rem; }
    .dropzone {
      border: 2px dashed #888; padding: 2rem; text-align: center;
      margin-bottom: 1rem; border-radius: 8px;
    }
    .progress-bar {
      width: 100%; height: 10px; background: #eee; margin-top: 1rem;
      border-radius: 5px; overflow: hidden;
    }
    .progress-fill {
      height: 100%; width: 0; background: green; transition: width .3s;
    }
  </style>
</head>
<body>
  <h2>Upload Your Video</h2>
  <input type="file" id="videoInput" accept=".mp4,.mov"><br><br>

  <h3>Select Quality</h3>
  <select id="qualitySelect">
    <option value="high">High</option>
    <option value="medium">Medium</option>
  </select><br><br>

  <button id="compressBtn">Compress Video</button>

  <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>

  <script>
    const { ipcRenderer } = require('electron');
    const compressBtn = document.getElementById('compressBtn');
    const videoInput = document.getElementById('videoInput');
    const qualitySelect = document.getElementById('qualitySelect');
    const progressFill = document.getElementById('progressFill');

    compressBtn.onclick = async () => {
      const file = videoInput.files[0];
      if (!file || !file.path) {
        alert('Please select a valid video file.');
        return;
      }

      const quality = qualitySelect.value;

      try {
        const output = await ipcRenderer.invoke('compress-video', {
          filePath: file.path,
          quality: quality
        });
        alert('✅ Compression complete!\nSaved to: ' + output);
      } catch (err) {
        alert('❌ Error: ' + err.message);
      }
    };

    ipcRenderer.on('ffmpeg-progress', (e, percent) => {
      progressFill.style.width = percent + '%';
    });
  </script>
</body>
</html>
