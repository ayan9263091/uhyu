<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Video Compressor</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>🎥 Video Compressor</h1>

  <button id="browseBtn">Browse Video</button>
  <div id="selectedFile">No file selected</div>

  <label for="quality">Quality:</label>
  <select id="quality">
    <option value="high">High</option>
    <option value="medium">Medium</option>
  </select>
  <button id="compressBtn">Compress</button>

  <div class="progress-wrapper">
    <progress id="progressBar" value="0" max="100"></progress>
    <span id="progressText">0%</span>
  </div>

  <script>
    const browseBtn   = document.getElementById('browseBtn');
    const selectedDiv = document.getElementById('selectedFile');
    const qualitySel  = document.getElementById('quality');
    const compressBtn = document.getElementById('compressBtn');
    const progressBar = document.getElementById('progressBar');
    const progressText= document.getElementById('progressText');

    let filePath = null;

    browseBtn.addEventListener('click', async () => {
      const path = await window.electronAPI.openFile();
      if (path) {
        filePath = path;
        selectedDiv.textContent = `Selected: ${path}`;
      }
    });

    compressBtn.addEventListener('click', () => {
      if (!filePath) {
        alert('Please browse and select a video first.');
        return;
      }
      progressBar.value = 0;
      progressText.textContent = '0%';
      window.electronAPI.startCompression(filePath, qualitySel.value);
    });

    window.electronAPI.onProgress(pct => {
      progressBar.value = pct;
      progressText.textContent = pct + '%';
    });

    window.electronAPI.onCompleted(message => {
      if (message.startsWith('Error')) {
        alert('❌ ' + message);
      } else {
        alert('✅ Compression complete!\nOutput saved to:\n' + message);
      }
    });
  </script>
</body>
</html>
